<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Loza Beach Game - Pixel Edition</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: url('beach.jpg') no-repeat center center;
        background-size: cover;
    }
    canvas { display: block; margin: 0 auto; background: transparent; }
</style>
</head>
<body>
<audio id="bgMusic" src="background.mp3" loop></audio>
<audio id="victoryMusic" src="victory.mp3"></audio>
<canvas id="gameCanvas" width="800" height="400"></canvas>
<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let loza = { x: 50, y: 300, w: 30, h: 30, vy: 0, onGround: false };
let gravity = 0.5;
let keys = {};
let message = "";
let gameEnded = false;

let monsters = [
    { x: 200, y: 340, w: 16, h: 16, dir: -0.3 }, // left
    { x: 400, y: 300, w: 16, h: 16, dir: 0.3 },  // right
    { x: 600, y: 260, w: 16, h: 16, dir: -0.3 }  // left
];

let obstacles = [
    { x: 150, y: 360, w: 50, h: 40 },
    { x: 300, y: 320, w: 50, h: 80 },
    { x: 450, y: 280, w: 50, h: 120 },
    { x: 600, y: 240, w: 50, h: 160 },
    { x: 750, y: 200, w: 50, h: 200 }
];

let heart = { x: 780, y: 150, w: 20, h: 20 };

document.addEventListener('keydown', e => keys[e.key] = true);
document.addEventListener('keyup', e => keys[e.key] = false);

function rectCollide(a, b) {
    return a.x < b.x + b.w &&
           a.x + a.w > b.x &&
           a.y < b.y + b.h &&
           a.y + a.h > b.y;
}

function update() {
    if (gameEnded) return;
    loza.vy += gravity;
    loza.y += loza.vy;

    if (keys['ArrowLeft']) loza.x -= 2;
    if (keys['ArrowRight']) loza.x += 2;
    if (keys['ArrowUp'] && loza.onGround) {
        loza.vy = -8;
        loza.onGround = false;
    }

    loza.onGround = false;
    for (let obs of obstacles) {
        if (rectCollide(loza, obs)) {
            if (loza.vy > 0 && loza.y + loza.h - loza.vy <= obs.y) {
                loza.y = obs.y - loza.h;
                loza.vy = 0;
                loza.onGround = true;
            }
        }
    }

    monsters.forEach(m => {
        m.x += m.dir;
        if (m.x < m.startX - 20 || m.x > m.startX + 20) m.dir *= -1;
        if (rectCollide(loza, m)) {
            loza.x = 50;
            loza.y = 300;
            loza.vy = 0;
        }
    });

    if (rectCollide(loza, heart)) {
        message = "Loza I will miss u enjoy my love";
        document.getElementById('bgMusic').pause();
        document.getElementById('victoryMusic').play();
        gameEnded = true;
    }
}

function drawPixelCat(x, y, w, h) {
    ctx.fillStyle = '#FFD700'; // cat body color
    ctx.fillRect(x, y, w, h);
    ctx.fillStyle = 'black';
    ctx.font = '10px Arial';
    ctx.fillText('Loza', x, y - 2);
}

function drawPixelPill(x, y, w, h) {
    ctx.fillStyle = 'red';
    ctx.fillRect(x, y, w/2, h);
    ctx.fillStyle = 'yellow';
    ctx.fillRect(x + w/2, y, w/2, h);
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawPixelCat(loza.x, loza.y, loza.w, loza.h);

    ctx.fillStyle = 'brown';
    obstacles.forEach(o => ctx.fillRect(o.x, o.y, o.w, o.h));

    ctx.fillStyle = 'pink';
    ctx.fillRect(heart.x, heart.y, heart.w, heart.h);

    monsters.forEach(m => drawPixelPill(m.x, m.y, m.w, m.h));

    if (message) {
        ctx.fillStyle = 'black';
        ctx.font = '20px Arial';
        ctx.fillText(message, 200, 50);
    }
}

function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

monsters.forEach(m => m.startX = m.x);
document.getElementById('bgMusic').play();
loop();
</script>
</body>
</html>
